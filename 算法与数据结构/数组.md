# 数组

**数组是一种线性表数据结构。它用一组连续的内存空间，来存储一组具有相同类型的数据**

### 线性表（Linear List）：

就是数据排成像一条线一样的结构。每个线性表上的数据最多只有前后两个方向。**链表、队列、栈等**也是线性表结构

### 非线性表：

比如**二叉树、堆、图**等，之所以叫非线性，是因为数据之间不是简单的前后关系

### 连续的内存空间和相同类型的数据

因为这一特性，所以有**随机访问**的特性，但是这两个限制让数组的很多操作变得低效，例如：在数组中插入、删除一条数据，为了保证连续性，就需要做大量的数据搬移工作。

### 数组是如何实现下标随机访问数组元素？

计算机会给每个内存单元分配一个地址，计算机通过地址来访问内存中的数据。寻址公式如下：

```java
a[i] _address = base_address + i * data_type_size
```

其中，date_type_size表示数组中每个元素的大小

#### 数组和链表的区别：

1. 链表适合插入、删除，时间复杂度为O(1)
2. 数组适合查找，支持随机访问，根据下标随机访问的时间复杂度为O(1);

### 低效的“插入”和“删除”：

#### 插入：

数组长度为n，需要将一个数据插入到k位置，为了将位置腾出来，则需要将后面的数据进行整体后移，所以时间复杂度为O(n)

这时候一个更好的办法则是，将k位置的数据挪到数组最后，然后将数据放入k位置，此时的时间复杂为O(1)

### 删除：

数组长度为n，需要将k位置的数据删除，为了保证位置连续，则需要将后面的数据进行整体前移，所以时间复杂度为O(n)

为了避免数据的多次迁移，可以在每次删除时先记录已删除的数据，，当数组没有更多的空间存储数据时，再触发一次真正的删除操作。这也是**JVM标记清楚垃圾回收算法的核心思想**，**mysql B+数的删除也是这么做的**

### 数组容器

**数组是一种基本数据结构，而平时使用的list等语言中的数据类型属于对它的封装，也称之为容器，容器会帮助开发者自动实现一些功能去实现对数组的操作**

java提供了ArrayList容器：其优势在于**可以将很多数组细节封装起来，而且支持动态扩容**，每次在内存不够时，会自动扩容到1.5倍大小，java8中默认为10个初始单位

因为涉及到扩容的问题，建议在**创建ArrayList时事先指定数据大小**

#### 数组使用的情况：

1. ArrayList不能存储基本类型，需要转换为包装类，而且对性能会有影响。所以在特别关注性能，或者希望使用基本类型时可以使用数组
2. 如果数据大小已知，并且多是随机查询，用不到ArrayList的大部分方法时，也可以直接使用数组
3. 多维数组使用数组更清晰

### 数据下标为何从0开始？

```java
a[k] _address = base_address + k * type_size
```

根据上面的寻址公式来说，第一个数据的位置就是base_address，如果使用1开始的话，就需要在k替换成（k-1），对于CPU来说相当于多执行了一次减法指令

## 小结

数据用一组连续的内存空间存储类型相同的数据，最大的特别是支持随机访问，但是插入、删除的效率较低，时间复杂度为O(n)，业务开发中可以使用语言提供的容器，底层开发建议使用数组。

